<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ThreeJS</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="./style.css" type="text/css" />
    <script type="importmap">
      {
        "imports": {
          "three": "https://cdn.jsdelivr.net/npm/three@0.163.0/build/three.module.js",
          "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.163.0/examples/jsm/"
        }
      }
    </script>
    <script src="https://cdn.jsdelivr.net/npm/dat.gui@0.7.9/build/dat.gui.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/d3@7"></script>
  </head>
  <body>
    <canvas class="webgl"></canvas>
    <script type="module" src="./main.js"></script>
    <div class="hud top">
      <div class="btn-group" role="group" aria-label="Basic example">
        <button id="gradDescent" type="button" class="btn btn-info btn-sm">Start Simulation</button>
        <button id="genPoints" type="button" class="btn btn-info btn-sm">Generate Points</button>
      </div>
    </div>
    <div class="hud bottom">
      <p class="d-inline-flex gap-1">
        <button class="btn btn-info btn-sm" type="button" data-bs-toggle="collapse" data-bs-target="#collapse" aria-expanded="false" aria-controls="collapse">
          What is this?
        </button>
      </p>
      <div class="collapse" id="collapse">
        <div class="card card-body info text-white">
          The goal of this simulation is to visualize a large number of points performing gradient descent on a mock loss function. I created it to gain familiarity with Three.js while hopefully helping others visualize this algorithm central to machine learning.
          <br><br>
          Note that in real machine learning, the model would be analogous to only a single point—multiple are shown to be more visually interesting and show the effect of random weight initialization. Further, the real loss function would have many many more dimensions, making it almost impossible to visualize. Lastly, unlike real machine learning, the gradient of the loss function is not actually being computed here. Instead, this simulation approximates the gradient through numerical differentiation—namely, the input values are separately changed by a very small amount and the effects on the loss are combined.
          <br><br>
          The function and graphing code is adapted from <a href="https://observablehq.com/@laotzunami/3d-graphs-with-three-js" target="_blank" rel="noopener noreferrer">https://observablehq.com/@laotzunami/3d-graphs-with-three-js</a>
        </div>
      </div>
    </div>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
  </body>
</html>
